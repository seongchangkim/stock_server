import{f as v,a as y,b as I}from"./twelve_data_global_key-22d9eb43.js";import{a as u}from"./axios-a900fd7e.js";import{_ as x,r as w,o as n,c as d,a as s,y as p,B as m,F as k,g as b,e as _,f as L,t as h,b as S}from"./index-d85befdf.js";const P={data(){return{writer:"",count:0,portName:"",initialPrice:0,stockSearchList:Array.from({length:10},e=>[]),stockInputList:Array.from({length:10},e=>""),ratioInputList:Array.from({length:10},e=>0)}},props:{index:String},setup(){return{faPlus:v,faXmark:y}},methods:{addStockInput(){if(this.count==10){alert("주식을 10개까지 등록할 수 있습니다!");return}this.count+=1},deleteStockInput(e){if(this.count==1){alert("해당 주식 입력창을 삭제할 수 없습니다.");return}this.count-=1,this.stockInputList.splice(e,1),this.ratioInputList.splice(e,1),this.stockSearchList.splice(e,1),this.stockInputList.push(""),this.ratioInputList.push(0),this.stockSearchList.push([])},async searchStock(e,t){this.stockSearchList.forEach(a=>console.log(a));var r=e.target.value;this.stockInputList[t]=r,this.stockSearchList[t]!=={}&&(this.stockSearchList[t]=[]);const c=e.target.value;var i=await u.get(`https://api.twelvedata.com/symbol_search?outputsize=30&country=United States&symbol=${c}`,{headers:{Authorization:`apikey ${I}`}});this.stockSearchList[t]=i.data.data},selectStock(e,t,r){console.log(`text before : ${this.stockInputList[e]}`),this.stockInputList[e]=t,r.target.value=this.stockInputList[e],console.log(`text after : ${this.stockInputList[e]}`),this.stockSearchList[e]=[]},async updateStockPorfolio(){let e=0;if(this.ratioInputList.forEach(c=>e+=c*1),e<100){alert("주식 포트폴리오 총 비율이 100%이어야 합니다.");return}var t={portIndex:this.index,initialPrice:this.initialPrice,title:this.portName,stock:`${this.stockInputList}`,ratio:`${this.ratioInputList}`},r=await u.patch(`${u.defaults.baseURL}api/stock/portfolio/edit`,t,{withCredentials:!0});r.data.success&&(alert("포트폴리오 수정되었습니다."),this.$router.push({name:"PortDetail",params:{index:this.index}}))}},async beforeCreate(){var e={portIndex:this.$route.params.index},t=await u.get(`${u.defaults.baseURL}api/stock/portfolio/detail`,{params:e},{withCredientials:!0});this.portName=t.data.portInfo.title,this.initialPrice=t.data.portInfo.initial_price,this.writer=t.data.portInfo.writer;for(var r=1;r<=10;r++){if(t.data.portInfo[`stock${r}`]==="")return;this.stockInputList[r-1]=t.data.portInfo[`stock${r}`],this.ratioInputList[r-1]=t.data.portInfo.Ratio[`stock${r}_ratio`],this.count++}}},C={class:"md:grid md:grid-cols-1 md:gap-6"},N={class:"mt-5 md:col-span-1 md:mt-0"},V={class:"space-y-6 bg-white px-4 py-5 sm:p-6"},U=s("div",{class:"text-lg font-semibold"},"자산 포트폴리오 수정",-1),z={class:"col-span-6 sm:col-span-3"},A=s("label",{for:"title",class:"block text-sm font-medium text-gray-700"},"포트폴리오 이름",-1),B={class:"col-span-6 sm:col-span-3"},D=s("label",{for:"writer",class:"block text-sm font-medium text-gray-700"},"이름",-1),E={class:"col-span-6 sm:col-span-3"},R=s("label",{for:"price",class:"block text-sm font-medium text-gray-700"},"총 비용",-1),T={id:"assetInput",class:"col-span-6 mb-8 sm:col-span-3"},j=s("div",{class:"mb-4"},[s("label",{class:"block text-sm font-medium text-gray-700"},"자산 비율")],-1),F={class:"flex-none mr-2"},X={class:"relative flex-auto w-64"},K=["onInput","value"],M={key:0,class:"w-full absolute z-50 overflow-auto touch-auto cursor-default h-40 bg-white border-2 border-solid border-black rounded-md"},W={class:"hover:bg-gray-300 cursor-default my-2 ml-2"},q=["onClick"],G={class:"flex-auto w-24"},H=["onUpdate:modelValue"],J={class:"flex-none ml-4 mt-1"},O={class:"col-span-6 mb-8 sm:col-span-3"},Q={class:"bg-gray-50 px-4 py-3 text-right sm:px-6"};function Y(e,t,r,c,i,a){const f=w("svg-icon");return n(),d("div",C,[s("div",N,[s("div",V,[U,s("div",z,[A,p(s("input",{type:"text",name:"title",id:"title",autocomplete:"title",class:"mt-1 block w-full rounded-md border-2 border-solid border-black sm:text-sm","onUpdate:modelValue":t[0]||(t[0]=o=>i.portName=o)},null,512),[[m,i.portName]])]),s("div",B,[D,p(s("input",{type:"text",name:"writer",id:"writer",autocomplete:"writer",class:"mt-1 block w-full rounded-md border-2 border-solid border-black sm:text-sm","onUpdate:modelValue":t[1]||(t[1]=o=>i.writer=o),disabled:!0},null,512),[[m,i.writer]])]),s("div",E,[R,p(s("input",{type:"text",name:"price",id:"price",autocomplete:"price",class:"mt-1 block w-full rounded-md border-2 border-solid border-black sm:text-sm","onUpdate:modelValue":t[2]||(t[2]=o=>i.initialPrice=o)},null,512),[[m,i.initialPrice]])]),s("div",T,[j,(n(!0),d(k,null,b(i.count,o=>(n(),d("div",{class:"flex mb-3",key:o},[s("div",F,"자산"+h(o)+" :",1),s("div",X,[s("input",{type:"text",name:"stock",id:"stock",autocomplete:"stock",class:"w-full rounded-md border-2 border-solid border-black sm:text-sm",onInput:l=>a.searchStock(l,o-1),value:i.stockInputList[o-1]},null,40,K),i.stockSearchList[o-1].length>0?(n(),d("div",M,[(n(!0),d(k,null,b(i.stockSearchList[o-1],(l,Z)=>(n(),d("div",W,[s("p",{class:"cursor-default",onClick:g=>a.selectStock(o-1,l.symbol,g)},h(l.symbol)+"("+h(l.instrument_name)+") ",9,q)]))),256))])):S("",!0)]),s("div",G,[p(s("input",{type:"text",name:"percent",id:"percent",autocomplete:"percent",class:"ml-2 w-full rounded-md border-2 border-solid border-black sm:text-sm","onUpdate:modelValue":l=>i.ratioInputList[o-1]=l},null,8,H),[[m,i.ratioInputList[o-1]]])]),s("div",J,[_(f,{"fa-icon":c.faXmark,size:16,onClick:l=>a.deleteStockInput(o-1)},null,8,["fa-icon","onClick"])])]))),128))]),s("div",O,[s("button",{class:"w-full inline-flex justify-center rounded-md border border-transparent bg-indigo-600 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:t[3]||(t[3]=(...o)=>a.addStockInput&&a.addStockInput(...o))},[_(f,{"fa-icon":c.faPlus,size:18,class:"mr-2"},null,8,["fa-icon"]),L("자산 추가 ")])])]),s("div",Q,[s("button",{onClick:t[4]||(t[4]=(...o)=>a.updateStockPorfolio&&a.updateStockPorfolio(...o)),class:"inline-flex justify-center rounded-md border border-transparent bg-indigo-600 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"}," 수정 ")])])])}const et=x(P,[["render",Y]]);export{et as default};
